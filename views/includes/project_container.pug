div(class="project-container")
  div(class="project-details")
    h2 #{project.title}

    if project.image
      div(class="project-image")
        img(src=project.image alt=project.title)

    if project.description
      p #{project.description}
    
    if project.remote
      div.remote-wrapper(style="width: 50vmin; height: 50vmin; position: relative;")
        div.loader#loader(style="width: 100%; height: 100%; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); z-index: 10; transition: opacity .5s")
          include car_loading
        div#iframe-invisible(style="width: 100%; height: 100%; overflow: hidden; opacity: 0, z-index: 1; transition: opacity .5s")
          
    if project.demo
      div(class="project-demo")
        video(src=project.demo controls)

    if project.gif
      div(class="project-gif")
        img(src=project.gif alt="Demo GIF for " + project.title)
        
  script.
    var remoteUrl = !{JSON.stringify(project.remote)};
    var container = document.getElementById("iframe-invisible");
    var loader = document.getElementById("loader");

    setTimeout(() => {
      var frame = document.createElement("iframe");
      frame.id = "remote-iframe"
      frame.src = remoteUrl;
      frame.style.border = "none";
      frame.width = "100%";
      frame.height = "100%";

      frame.addEventListener("load", function() {
        console.log("Iframe has loaded and container is now visible.");
        container.style.opacity = 1;
        loader.style.opacity = 0;
        setTimeout(() => {
          loader.style.display = "none";
        }, "1000");
      });
      console.log("AAA.");

      container.appendChild(frame);
      return frame;
    }, "1000");
